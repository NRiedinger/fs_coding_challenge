<div class="card">
    <p-table
        [value]="tickets()"
        [tableStyle]="{ 'min-width': '60rem' }"
        [paginator]="true"
        [rows]="rows"
        [showCurrentPageReport]="true"
        [first]="first"
        [resizableColumns]="true"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
        (onPage)="pageChange($event)"
        [rowsPerPageOptions]="[10, 25, 50]"
        [loading]="loading"
    >
        <ng-template #header>
            <tr>
                <th style="width: 2%">#</th>
                <th>Subject</th>
                <th style="width: 5%">Priority</th>
                <th style="width: 10%">Category</th>
                <th style="width: 15%">Created</th>
            </tr>
        </ng-template>
        <ng-template #body let-ticket>
            <tr class="row-ticket" (click)="onTicketClick(ticket.id)">
                <td>
                    @if (loading) {
                        <p-skeleton />
                    } @else {
                        {{ ticket.id }}
                    }
                </td>
                <td>
                    @if (loading) {
                        <p-skeleton />
                    } @else {
                        {{ ticket.subject }}
                    }
                </td>
                <td>
                    @if (loading) {
                        <p-skeleton />
                    } @else {
                        <p-tag
                            [value]="ticket.priority"
                            [severity]="getPrioritySeverity(ticket.priority)"
                        />
                    }
                </td>
                <td>
                    @if (loading) {
                        <p-skeleton />
                    } @else {
                        {{ ticket.category }}
                    }
                </td>
                <td>
                    @if (loading) {
                        <p-skeleton />
                    } @else {
                        {{ ticket.created_at | date: 'medium' }}
                    }
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
